<!DOCTYPE html>
<html>
  <head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
      body {
        font-family:sans-serif;
        color: #474747;
      }

      .srBar {
        fill: #C31C45;
      }

    </style>
  </head>

  <body>
    <div id="quarters-chart-flex">
      <script>
        var callbackError;
        var callbackData;
        d3.csv("https://couchux.github.io/BAMA-MSU_SRbyQuarter.csv",
          function(error, data) {
            data.forEach(function(d) {
              d.SuccessRate = +d.SuccessRate
              d.Quarter = "Q" + d.Quarter
            });
          callbackError = error;
          callbackData = data;

          var chartContainerWidth = document.getElementById("quarters-chart-flex").offsetWidth;
          var barHeight = 40;
          var maxSR = d3.max(callbackData, function(d) { return d.SuccessRate });
          var meanSR = d3.mean(callbackData, function(d) { return d.SuccessRate });
          var maxIndex = d3.max(callbackData, function(d,i) { return (i + 1) });
          var svgHeight =  maxIndex * barHeight * 1.05;
          var svgContainer = d3.select("#quarters-chart-flex").append("svg")
                                                              .attr("width","100%")
                                                              .attr("height",svgHeight);

          var bars = svgContainer.selectAll("rect").data(callbackData).enter()
                                                               .filter(function(d) { return d.Team = "Alabama" })
                                                               .append("rect")
                                                               .attr("class","srBar");

          var barAttrs = svgContainer.selectAll("rect")
                                      .attr("width",function(d,i) {return d.SuccessRate / maxSR * chartContainerWidth})
                                      .attr("height",barHeight)
                                      .attr("y",function(d,i){ return i * barHeight * 1.05})

          });
      </script>
    </div>

  </body>


</html>
